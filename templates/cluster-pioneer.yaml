# yaml-language-server: $schema=../schema/cluster-schema.json
# Zero Touch Cluster Configuration - Pioneer Template
# Optimized for: 1-4 nodes, learning and experimentation, minimal hardware
# Storage: Local-path only (simple, fast, minimal resource usage)
# Recommended for: First-time users, testing, resource-constrained labs

cluster:
  name: "ztc-pioneer"
  description: "A compact ZTC cluster for exploration and learning"
  version: "1.0.0"

network:
  subnet: "192.168.50.0/24"
  gateway: "192.168.50.1"
  pod_cidr: "10.42.0.0/16"
  service_cidr: "10.43.0.0/16"
  dns:
    enabled: true
    # In this mode, DNS runs on the master node
    server_ip: "192.168.50.10"
    domain: "homelab.lan"
    upstreams:
      - "8.8.8.8"
      - "1.1.1.1"

nodes:
  ssh:
    public_key_path: "~/.ssh/id_ed25519.pub"
    private_key_path: "~/.ssh/id_ed25519"
    username: "ubuntu"
    
  cluster_nodes:
    k3s-master:
      ip: "192.168.50.10"
      role: "master"
      resources:
        cpu: "2"
        memory: "4Gi"
    k3s-worker-01:
      ip: "192.168.50.11"
      role: "worker"
      resources:
        cpu: "2"
        memory: "4Gi"

storage:
  default_storage_class: "local-path"
  
  local_path:
    enabled: true
  
  longhorn:
    enabled: false
    namespace: "longhorn-system"
    replica_count: 2
    storage_class:
      name: "longhorn"
      reclaim_policy: "Delete"
    settings:
      backup_target: ""
      default_data_path: "/var/lib/longhorn/"
  
  nfs:
    enabled: false

components:
  sealed_secrets:
    enabled: true
  
  argocd:
    enabled: true
    namespace: "argocd"
  
  monitoring:
    enabled: true
    namespace: "monitoring"
    components:
      prometheus: true
      grafana: true
      alertmanager: true
    resources:
      prometheus:
        memory_limit: "1Gi"
        storage_size: "10Gi"
      grafana:
        memory_limit: "128Mi"
  
  gitea:
    enabled: true
    namespace: "gitea"
    features:
      container_registry: false
      actions_runner: false
    resources:
      memory_limit: "256Mi"
      storage_size: "5Gi"
  
  homepage:
    enabled: true
    namespace: "homepage"
    features:
      service_discovery: true
      cluster_metrics: true
  
  minio:
    enabled: false
    namespace: "minio"
    storage_class: "local-path"
    replicas: 1
    storage_size: "50Gi"
    console:
      enabled: true
      hostname: "minio-console.homelab.lan"
    api:
      hostname: "s3.homelab.lan"
    credentials:
      access_key: ""
      secret_key: ""
    resources:
      memory_limit: "256Mi"
      cpu_limit: "250m"

workloads:
  auto_deploy_bundles:
    - "starter"
  templates:
    default_storage_class: "local-path"
    default_memory_limit: "128Mi"
    default_cpu_limit: "100m"

deployment:
  phases:
    infrastructure: true
    secrets: true
    networking: true
    storage: true
    system_components: true
    gitops: true
    workloads: true
  options:
    wait_for_ready: true
    timeout_minutes: 10
    retry_failed: true
    backup_on_success: true

advanced:
  ansible:
    inventory_path: "ansible/inventory/hosts.ini"
    vault_password_file: ".ansible-vault-password"
  kubernetes:
    version: "v1.28.4+k3s1"
    container_runtime: "containerd"
  security:
    auto_generate_passwords: true
    password_length: 16
    enable_rbac: true
  backup:
    auto_backup_secrets: true
    backup_location: "."
    retention_days: 7
